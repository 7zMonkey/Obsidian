---
title: 单例模式
tags: 
	- 设计模式
categories: 设计模式
date: 2023-09-01 06:23:23
hidden: false
---
单例模式，也就是要确保在某一个类在全剧中只有一个实例，并且提供一个全局的访问点来访问这一
在前端开发中可以使用闭包实现一个简单的单例模式，将一些配置内容或者一些其他内容放在一个单例中使用其他内容访问。

我们将通过闭包实现一个配置信息的管理，首先我们写一个简单的闭包代码：

```js
const createConfig = (() {
	let config;
	return () => {
		return config;
	}
})()
```

但是我们要实现一个单例模式，就要在再次返回`instance`前做判断，如果没有 `instance` 要对他进行赋值。

```js
const createConfig = (() => {
	let config;
	return () => {
		if (!config) {
			config = { /* 创建单例对象的代码 */ };
		}
		return config;
	}
})()

const config = createConfig();
```

这样就是一个简单的单例模式的代码。 

我们不知想要一个简单的单例模式，也想要一个可以设置删除的单例模式，我就的config 就不应该是一个简单的配置对象，而是一个对象其中包含简单的配置对象。 

```js
const createConfig = (() => {
	let instance;
	return () => {
		 // 如果不存在 instance 就初始化
		if (!instance) {
			// 获取 localStorage 信息
			const config = JSON.parse(localStorage.getItem('config') ?? '{}')
			instance = {
				config,
				set ( key, value ) {
					this.config[key] = value;
					localStorage.setItem('config', 
						JSON.stringify(this.config ?? {})
					);
				}
			};
		}
		return instance;
	}
})();

// 初始化两次
const config = createConfig();
const config2 = createConfig();
console.log(
	'config:', config.config,
	'config2:', config2.config
	);
// 修改 config 观察 config2 信息
config.set('key', 0);
console.log('config2.config', config2.config);
```